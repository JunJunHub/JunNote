---
datetime: 2025-06-05T17:25:00
aliases:
  - Docker åŸºæœ¬åŸç†ï¼›Docker å¸¸ç”¨å‘½ä»¤ï¼›
tags:
  - Docker
---

 <img src="./kedacom_logo.png" alt="kedacom" style="text-align:left;zoom:100%;" />

















<h1 align = "center" > Dockerå­¦ä¹ ç¬”è®° </h1>

<center> (ä»…ä¾›å†…éƒ¨ä½¿ç”¨) </center>























|  ç‰ˆ  æœ¬  å·ï¼š  |      V0.1         |
| -------------------: | :------------------- |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä¿ å¯† ç­‰ çº§ï¼š | â– ç§˜å¯†  â–¡æœºå¯†  â–¡ç»å¯† |
|              |                     |
| ç¼– åˆ¶ï¼š       | ææ°¸å†›              |
| å®¡ æ ¸ï¼š       | ææ°¸å†›              |








<div STYLE="page-break-after: always;"></div>
<h1 align = "left" > ä¿®è®¢è®°å½• </h1>

| æ—¥æœŸ         | ç‰ˆæœ¬å·  | æè¿°         | ä½œè€…       |
| ------------ | ------- | ------------ | ---------- |
| **2024-05-03**  | **0.1** | **åˆç¨¿å®Œæˆ** | **ææ°¸å†›** |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |
|                                                              |         |              |            |



<div STYLE="page-break-after: always;"></div>
<h1 align = "left" > ç›®å½• </h1>
[TOC]



<div STYLE="page-break-after: always;"></div>
## å‰è¨€

**å‚è€ƒèµ„æ–™:**

[Dockerå®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)

[Dockerå®˜æ–¹å®‰è£…æ–‡æ¡£](https://docs.docker.com/engine/install/)

[Dockerå®‰è£…åŒ…oräºŒè¿›åˆ¶æ–‡ä»¶ä¸‹è½½](https://download.docker.com/)

[Dockerå¼€æºé¡¹ç›® - github](https://github.com/moby/moby)

[k8så®˜æ–¹æ–‡æ¡£](https://kubernetes.io/zh/docs/home/)

[The Linux Kernel Archives](https://www.kernel.org/)

[centoså®˜ç½‘](https://vault.centos.org/)

[DockeråŸºç¡€åŸç†è¯¦è§£_lks1139230294çš„åšå®¢-CSDNåšå®¢_dockeråŸç†è¯¦è§£](https://blog.csdn.net/lks1139230294/article/details/67639881)

[Docker çš„å‰ä¸–ä»Šç”Ÿ - å“ˆå–½æ²ƒå¾·å…ˆç”Ÿ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/mrhelloworld/p/docker1.html)

[Dockeré«˜çº§ç½‘ç»œé…ç½®_ç¥¯minçš„åšå®¢-CSDNåšå®¢_docker networké…ç½®](https://blog.csdn.net/qq_44251046/article/details/90695178?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_baidulandingword-0&spm=1001.2101.3001.4242)

[Dockerç½‘ç»œè¯¦è§£â€”â€”åŸç†ç¯‡_meltsnowçš„åšå®¢-CSDNåšå®¢_docker ç½‘ç»œ](https://blog.csdn.net/meltsnow/article/details/94490994?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujs&dist_request_id=1332048.22019.16195228904933879&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujs)

[KubeEdge vs K3Sï¼šKubernetesåœ¨è¾¹ç¼˜è®¡ç®—åœºæ™¯çš„æ¢ç´¢_å‹‡å¾€ç›´å‰çš„ä¸“æ -CSDNåšå®¢_k3s kubeedge](https://blog.csdn.net/zl1zl2zl3/article/details/89285904)

[å†…æ ¸ç‰ˆæœ¬ä¸å‘è¡Œç‰ˆæœ¬ï¼ˆCentOS & Ubuntuï¼‰çš„å¯¹åº”å…³ç³»](https://blog.csdn.net/zhaihaibo168/article/details/102673669)

[Docker æ•™ç¨‹ | èœé¸Ÿæ•™ç¨‹ (runoob.com)](https://www.runoob.com/docker/docker-tutorial.html)

[Dockerç®€ä»‹ä»¥åŠDockerå†å² (biancheng.net)](http://c.biancheng.net/view/3118.html)

[Installation on Mac OS X | Docker ä¸­æ–‡æŒ‡å— (widuu.com)](https://www.widuu.com/chinese_docker/installation/mac.html)

[å®¹å™¨å’Œé•œåƒçš„åŒºåˆ«å—ï¼Ÿ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/74802067?from_voters_page=true)

[Linuxå’ŒUNIXçš„å…³ç³»åŠåŒºåˆ«ï¼ˆè¯¦è§£ç‰ˆï¼‰ (biancheng.net)](http://c.biancheng.net/view/707.html)

[Runtime options with Memory, CPUs, and GPUs | Docker Documentation](https://docs.docker.com/config/containers/resource_constraints/)

[ä½¿ç”¨ docker å¯¹å®¹å™¨èµ„æºè¿›è¡Œé™åˆ¶ - DockOne.io](http://dockone.io/article/2569)

[Index of /doc/Documentation/cgroup-v1/ (kernel.org)](https://www.kernel.org/doc/Documentation/cgroup-v1/)

[Dockerèµ„æºç®¡ç†æ¢ç§˜ï¼šDockerèƒŒåçš„å†…æ ¸Cgroupsæœºåˆ¶-InfoQ](https://www.infoq.cn/article/docker-resource-management-cgroups/)



**å…³é”®è¯:**
`Docker`ã€`Dockerfile`ã€`Container`ã€`Image`ã€`Repository`



<div STYLE="page-break-after: always;"></div>
## Dockeræ¦‚è¿°

![docker](https://img-blog.csdnimg.cn/2020090516314249.png#pic_center)



### Docker çš„å†å²

Docker æ˜¯ PaaS æä¾›å•† dotCloud å¼€æºçš„ä¸€ä¸ªåŸºäº LXC çš„é«˜çº§å®¹å™¨å¼•æ“ï¼Œæºä»£ç æ‰˜ç®¡åœ¨ Github ä¸Šï¼ŒåŸºäº**goè¯­è¨€**å¹¶éµä»**Apache2.0**åè®®å¼€æºã€‚

### Docker ä¸è™šæ‹Ÿæœº

è™šæ‹Ÿæœºæ˜¯ç¡¬ä»¶å±‚è™šæ‹ŸåŒ–ï¼Œè™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶ï¼Œè¿è¡Œä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œç„¶ååœ¨è¿™ä¸ªç³»ç»Ÿä¸Šå®‰è£…å’Œè¿è¡Œè½¯ä»¶ã€‚ç³»ç»Ÿå±‚éš”ç¦»ã€‚
å®¹å™¨åŒ–æŠ€æœ¯ä¸æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿã€‚è¿›ç¨‹å±‚çš„éš”ç¦»ï¼ˆå…±äº«ä¸»æœºçš„å†…æ ¸ï¼‰ã€‚
å¦‚æœåº”ç”¨éœ€è¦æœ‰å†…æ ¸æ¨¡å—çš„é…åˆæˆ–è€…éœ€è¦è¿è¡Œåœ¨ä¸åŒçš„OSï¼Œç”¨è™šæ‹Ÿæœºæ›´å¥½ã€‚

![img](https://upload-images.jianshu.io/upload_images/12979420-a562cd670f2b8b02?imageMogr2/auto-orient/strip|imageView2/2/w/529/format/webp)



### Docker æ¶æ„

#### ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µ

- **é•œåƒï¼ˆImageï¼‰**ï¼šDocker é•œåƒï¼ˆImageï¼‰ï¼Œå°±ç›¸å½“äºæ˜¯ä¸€ä¸ª root æ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚å®˜æ–¹é•œåƒ ubuntu:16.04 å°±åŒ…å«äº†å®Œæ•´çš„ä¸€å¥— Ubuntu16.04 æœ€å°ç³»ç»Ÿçš„ root æ–‡ä»¶ç³»ç»Ÿã€‚
- **å®¹å™¨ï¼ˆContainerï¼‰**ï¼šé•œåƒï¼ˆImageï¼‰å’Œå®¹å™¨ï¼ˆContainerï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»å’Œå®ä¾‹ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚
- **ä»“åº“ï¼ˆRepositoryï¼‰**ï¼šä»“åº“å¯çœ‹æˆä¸€ä¸ªä»£ç æ§åˆ¶ä¸­å¿ƒï¼Œç”¨æ¥ä¿å­˜é•œåƒã€‚

Docker ä½¿ç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨ (C/S) æ¶æ„æ¨¡å¼ï¼Œä½¿ç”¨è¿œç¨‹APIæ¥ç®¡ç†å’Œåˆ›å»ºDockerå®¹å™¨ã€‚
Docker å®¹å™¨é€šè¿‡ Docker é•œåƒæ¥åˆ›å»ºã€‚
å®¹å™¨ä¸é•œåƒçš„å…³ç³»ç±»ä¼¼äºé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„å¯¹è±¡ä¸ç±»ã€‚

| Docker | é¢å‘å¯¹è±¡ |
| :----- | :--- |
| å®¹å™¨     | å¯¹è±¡   |
| é•œåƒ     | ç±»    |

![img](https://www.runoob.com/wp-content/uploads/2016/04/576507-docker1.png)

| æ¦‚å¿µ                   | è¯´æ˜            |
| :--------------------- | :---------------------------------- |
| Docker é•œåƒ(Images)    | Docker é•œåƒæ˜¯ç”¨äºåˆ›å»º Docker å®¹å™¨çš„æ¨¡æ¿ï¼Œæ¯”å¦‚ Ubuntu ç³»ç»Ÿã€‚  |
| Docker å®¹å™¨(Container) | å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ï¼Œæ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚|
| Docker å®¢æˆ·ç«¯(Client)  | Docker å®¢æˆ·ç«¯é€šè¿‡å‘½ä»¤è¡Œæˆ–è€…å…¶ä»–å·¥å…·ä½¿ç”¨ Docker SDK (https://docs.docker.com/develop/sdk/) ä¸ Docker çš„å®ˆæŠ¤è¿›ç¨‹é€šä¿¡ã€‚ |
| Docker ä¸»æœº(Host)      | ä¸€ä¸ªç‰©ç†æˆ–è€…è™šæ‹Ÿçš„æœºå™¨ç”¨äºæ‰§è¡Œ Docker å®ˆæŠ¤è¿›ç¨‹å’Œå®¹å™¨ã€‚       |
| Docker Registry        | Docker ä»“åº“ç”¨æ¥ä¿å­˜é•œåƒï¼Œå¯ä»¥ç†è§£ä¸ºä»£ç æ§åˆ¶ä¸­çš„ä»£ç ä»“åº“ã€‚Docker Hub([https://hub.docker.com](https://hub.docker.com/)) æä¾›äº†åºå¤§çš„é•œåƒé›†åˆä¾›ä½¿ç”¨ã€‚ä¸€ä¸ª Docker Registry ä¸­å¯ä»¥åŒ…å«å¤šä¸ªä»“åº“ï¼ˆRepositoryï¼‰ï¼›æ¯ä¸ªä»“åº“å¯ä»¥åŒ…å«å¤šä¸ªæ ‡ç­¾ï¼ˆTagï¼‰ï¼›æ¯ä¸ªæ ‡ç­¾å¯¹åº”ä¸€ä¸ªé•œåƒã€‚é€šå¸¸ï¼Œä¸€ä¸ªä»“åº“ä¼šåŒ…å«åŒä¸€ä¸ªè½¯ä»¶ä¸åŒç‰ˆæœ¬çš„é•œåƒï¼Œè€Œæ ‡ç­¾å°±å¸¸ç”¨äºå¯¹åº”è¯¥è½¯ä»¶çš„å„ä¸ªç‰ˆæœ¬ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ **<ä»“åº“å>:<æ ‡ç­¾>** çš„æ ¼å¼æ¥æŒ‡å®šå…·ä½“æ˜¯è¿™ä¸ªè½¯ä»¶å“ªä¸ªç‰ˆæœ¬çš„é•œåƒã€‚å¦‚æœä¸ç»™å‡ºæ ‡ç­¾ï¼Œå°†ä»¥ **latest** ä½œä¸ºé»˜è®¤æ ‡ç­¾ã€‚ |
| Docker Machine         | Docker Machineæ˜¯ä¸€ä¸ªç®€åŒ–Dockerå®‰è£…çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œå³å¯åœ¨ç›¸åº”çš„å¹³å°ä¸Šå®‰è£…Dockerï¼Œæ¯”å¦‚VirtualBoxã€ Digital Oceanã€Microsoft Azureã€‚ |

Docker ä¸»è¦ç”± **execdriver**ï¼Œ**networkdriver**ï¼Œ**graphdriver** æ¥è¿›è¡Œç®¡ç†ï¼å…¶ä¸­ **execdriver** è´Ÿè´£é…ç½®ä¿¡æ¯çš„ç®¡ç†ï¼Œç„¶åé€šè¿‡ **libcontainer** ä¸ **namespace**ï¼Œ**cgroups** æ¥å®Œæˆå®¹å™¨çš„åˆ›å»ºä¸åŠç®¡ç†ï¼è€Œ **networkdriver** ä¸»è¦æ˜¯å®Œæˆç½‘ç»œä¿¡æ¯çš„é…ç½®ï¼Œ**graphdriver** ä¸»è¦æ˜¯å¯¹å®¹å™¨é•œåƒçš„ç®¡ç†ï¼å®é™…ä¸Šå°±æ˜¯é€šè¿‡ **libvirt**ï¼Œ**lxc** ç­‰æŠ€æœ¯æ¥å®Œæˆ Docker æŠ€æœ¯ç®¡ç†çš„ã€‚

![è¿™é‡Œå†™å›¾ç‰‡æè¿°](https://img-blog.csdn.net/20170328154155595?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGtzMTEzOTIzMDI5NA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)


<div STYLE="page-break-after: always;"></div>
## å®‰è£… Docker

### Docker æ”¯æŒçš„å¹³å°

#### Windows

##### **ä¸€ã€Docker for Windows Server**

Docker Enterprise Edition for **Windows Server 2016**
https://store.docker.com/editions/enterprise/docker-ee-server-windows

##### **äºŒã€Docker for Windows**

Docker Community Edition for Windows
**Requires Microsoft Windows 10 Professional or Enterprise 64-bit.**
Docker CE for Windows is Docker designed to run on Windows 10. It is a native Windows application that provides an easy-to-use development environment for building, shipping, and running dockerized apps. Docker CE for Windows uses Windows-native Hyper-V virtualization and networking and is the fastest and most reliable way to develop Docker apps on Windows. Docker CE for Windows supports running both Linux and Windows Docker containers.

https://store.docker.com/editions/community/docker-ce-desktop-windows

##### **ä¸‰ã€For previous versionsï¼šDocker Toolbox**

https://www.docker.com/products/docker-toolbox
To run Docker, your machine must have a **64-bit operating system running Windows 7 or higher**. Additionally, you **must make sure that virtualization is enabled** on your machine.

windows å®¹å™¨æä¾›äº†ä¸¤ç§çº§åˆ«çš„éš”ç¦»æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯Windows Server container  å’ŒHyper-V Container ï¼Œå‰è€…é€šè¿‡è¿›ç¨‹å’Œå‘½åç©ºé—´éš”ç¦»æŠ€æœ¯æä¾›åº”ç”¨ç¨‹åºéš”ç¦»ã€‚ Windows Server å®¹å™¨ä¸å®¹å™¨ä¸»æœºå’Œè¯¥ä¸»æœºä¸Šè¿è¡Œçš„æ‰€æœ‰å®¹å™¨å…±äº«å†…æ ¸ã€‚ åè€…é€šè¿‡åœ¨é«˜åº¦ä¼˜åŒ–çš„è™šæ‹Ÿæœºä¸­è¿è¡Œæ¯ä¸ªå®¹å™¨ï¼Œåœ¨ç”± Windows Server å®¹å™¨æä¾›çš„éš”ç¦»ä¸Šæ‰©å±•ã€‚ åœ¨æ­¤é…ç½®ä¸­ï¼Œå®¹å™¨ä¸»æœºçš„å†…æ ¸ä¸ä¸ Hyper-V å®¹å™¨å…±äº«ã€‚

**ä¸‹é¢è¿™ä¸ªè¯´æ³•ï¼Œç›®å‰å·²ç»ä¸å‡†ç¡®äº† -- winä¸Šä¹Ÿæœ‰åŸºäºwinå†…æ ¸çš„å®¹å™¨åŒ–æŠ€æœ¯** 
*Dockerå¹¶éæ˜¯ä¸€ä¸ªé€šç”¨çš„å®¹å™¨å·¥å…·ï¼Œå®ƒä¾èµ–äºå·²å­˜åœ¨å¹¶è¿è¡Œçš„Linuxå†…æ ¸ç¯å¢ƒã€‚*
*Docker å®è´¨ä¸Šæ˜¯åœ¨å·²ç»è¿è¡Œçš„ Linux ä¸‹åˆ¶é€ äº†ä¸€ä¸ªéš”ç¦»çš„æ–‡ä»¶ç¯å¢ƒï¼Œå®ƒæ‰§è¡Œçš„æ•ˆç‡å‡ ä¹ç­‰åŒäºæ‰€éƒ¨ç½²çš„ Linuxä¸»æœºã€‚*
*å› æ­¤ï¼ŒDockerå¿…é¡»éƒ¨ç½²åœ¨ Linux å†…æ ¸çš„ç³»ç»Ÿä¸Šã€‚å¦‚æœå…¶ä»–ç³»ç»Ÿæƒ³éƒ¨ç½² Docker å°±å¿…é¡»å®‰è£…ä¸€ä¸ªè™šæ‹Ÿ Linux ç¯å¢ƒã€‚*
*Windowså¹³å°å®‰è£…Dockeræœ¬è´¨ä¸Šæ˜¯å…ˆè£…ä¸€ä¸ªLinuxè™šæ‹Ÿæœºï¼Œç„¶ååœ¨è™šæ‹Ÿæœºä¸­éƒ¨ç½²Dockerã€‚*

#### Linux

##### **Linuxæ“ä½œç³»ç»Ÿç¯å¢ƒè¦æ±‚**

æœ‰ä¸€ä¸ªshellè„šæœ¬ï¼Œç”¨äºæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å…·æœ‰Dockeræ‰€éœ€çš„ä¾èµ–é¡¹ï¼Œä»¥åŠæ£€æŸ¥å“ªäº›åŠŸèƒ½å¯ç”¨
https://github.com/docker/docker/blob/master/contrib/check-config.sh

- ä¸€èˆ¬æ¥è¯´å®‰è£…Docker(ç‰ˆæœ¬â‰¥ 1.8.0)ï¼Œè¦æ±‚Linuxå†…æ ¸ç‰ˆæœ¬ â‰¥ 3.10

- `iptables` version 1.4 or higher

- `git` version 1.7 or higher

- A `ps` executable, usually provided by `procps` or a similar package.

- [XZ Utils](https://tukaani.org/xz/) 4.9 or higher(ä¸€ä¸ªå‹ç¼©å·¥å…·)

- A [properly mounted](https://github.com/tianon/cgroupfs-mount/blob/master/cgroupfs-mount) `cgroupfs` hierarchy; a single, all-encompassing `cgroup` mount point is not sufficient. See Github issues [#2683](https://github.com/moby/moby/issues/2683), [#3485](https://github.com/moby/moby/issues/3485), [#4568](https://github.com/moby/moby/issues/4568))

è‹¥ docker å¯åŠ¨ä¸æ­£å¸¸éœ€è¦æ£€æŸ¥å†…æ ¸é…ç½®
cat /proc/filesystems
æŸ¥çœ‹æ˜¯å¦æœ‰ **cgroup** å’Œ **overlay**ï¼Œè‹¥ä¸å­˜åœ¨è¯·æ£€æŸ¥å†…æ ¸é…ç½®ã€‚
cat /proc/self/cgroup
æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ **devices**ã€**cpuset**ã€**memory**ã€**cpu,cpuacct**ã€‚

ä¸å­˜åœ¨çš„åŸå› ï¼š
1ï¼ å†…æ ¸é…ç½®æ²¡æœ‰é€‰ä¸Š
2ï¼ ç³»ç»Ÿå¯åŠ¨åç³»ç»Ÿçš„åˆå§‹åŒ–ç¨‹åºæ²¡æœ‰åˆå§‹åŒ–é…ç½®ï¼Œæ­£å¸¸é…ç½®çš„ **systemd** ä¼šåšå¥½ **cgroup** çš„åˆå§‹åŒ–



**å¸¸è§çš„ä¸»æµLinuxå‘è¡Œç‰ˆå®‰è£…æ–¹å¼**(CentOSã€ubuntuã€debian)
- é€šè¿‡ä¸ªå‘è¡Œç‰ˆçš„åŒ…ç®¡ç†å·¥å…·å®‰è£…(apt-getã€yum)
- å®˜æ–¹æä¾›çš„deb/rpmå®‰è£…åŒ…
- å®˜æ–¹æä¾›ç¼–è¯‘å¥½çš„äº†äºŒè¿›åˆ¶æ–‡ä»¶(x86_64ã€aarch64ã€armelã€armhfã€ppc64leã€s390x)

å¸¸è§Linuxå‘è¡Œç‰ˆéœ€è¦å®‰è£…ä¸‰ä¸ªè½¯ä»¶åŒ…:
containerd.ioã€docker-ce-ceã€docker-ce-cli

- containerd.io - daemon to interface with the OS API (in this case, LXC - Linux Containers), essentially decouples Docker from the OS, also provides container services for non-Docker container managers
- docker-ce - Docker daemon, this is the part that does all the management work, requires the other two on Linux
- docker-ce-cli - CLI tools to control the daemon, you can install them on their own if you want to control a remote Docker daemon



**å›½äº§æ“ä½œç³»ç»Ÿ(ä¸­æ ‡éº’éºŸã€é“¶æ²³éº’éºŸã€ä¸­ç§‘æ–¹å¾·ã€ç»Ÿä¿¡USO)**
**å…¶ä»–Linuxå‘è¡Œç‰ˆæˆ–ä¸€äº›åµŒå…¥å¼Linuxç³»ç»Ÿ**

- å®˜æ–¹æä¾›ç¼–è¯‘å¥½çš„äº†äºŒè¿›åˆ¶æ–‡ä»¶(x86_64ã€aarch64ã€armelã€armhfã€ppc64leã€s390x)



[2021å¹´å¼€å±€Linuxæ¡Œé¢100åæ’å](https://ywnz.com/linuxgcxt/8364.html)

https://download.docker.com/linux/


##### è¡¨1: åŸºäºLinuxå†…æ ¸å„å‘è¡Œç‰ˆæœ¬å®‰è£…Docker

| Linuxå‘è¡Œç‰ˆæœ¬ | æ”¯æŒçš„ç³»ç»Ÿæ¶æ„                       | Dockerç‰ˆæœ¬ / å®‰è£…æ–¹å¼    | ç³»ç»Ÿç‰ˆæœ¬                                                     |
| ------------- | ------------------------------------ | ------------------------ | ------------------------------------------------------------ |
| CentOS        | x86_64ã€amd64    ARM64ã€AARCH64      | yumåŒ…ç®¡ç†å·¥å…·/å®˜æ–¹å®‰è£…åŒ… | CentOS7åŠä»¥ä¸Š                                                |
| Fedora        | x86_64ã€amd64    ARM64ã€AARCH64      | yumåŒ…ç®¡ç†å·¥å…·/å®˜æ–¹å®‰è£…åŒ… | Fedora 32<br />Fedora 33 <br />Fedora 34                     |
| Debian        | x86_64ã€amd64    ARMã€ARM64ã€AARCH64 | dnfåŒ…ç®¡ç†å·¥å…·/å®˜æ–¹å®‰è£…åŒ… | Debian Bullseye 11 (testing)<br /> Debian Buster 10 (stable) |
| Ubuntu        | x86_64ã€amd64    ARMã€ARM64ã€AARCH64 | aptåŒ…ç®¡ç†å·¥å…·/å®˜æ–¹å®‰è£…åŒ… | Ubuntu Hirsute 21.04 <br />Ubuntu Groovy 20.10 <br />Ubuntu Focal 20.04 (LTS) <br />Ubuntu Bionic 18.04 (LTS) <br />Ubuntu Xenial 16.04 (LTS)<br /> |
| Raspbian      | ARMã€ARM64ã€AARCH64                  | aptåŒ…ç®¡ç†å·¥å…·/å®˜æ–¹å®‰è£…åŒ… | Raspbian Bullseye 11 (testing)<br />Raspbian Buster 10 (stable) |
|               |                                      |                          |                                                              |
|               |                                      |                          |                                                              |
|               |                                      |                          |                                                              |



##### è¡¨2: æ”¯æŒå®‰è£…Dockerçš„éLinuxå†…æ ¸ç³»ç»Ÿ

| æ“ä½œç³»ç»Ÿ   | æ”¯æŒçš„ç³»ç»Ÿæ¶æ„ | Dockerç‰ˆæœ¬ / å®‰è£…æ–¹å¼                                 |      |
| ---------- | -------------- | ----------------------------------------------------- | ---- |
| Win10      | x86_64/AMD64   | Docker Desktop for Windows (åŸºäºwin10çš„Hyper-Vè™šæ‹Ÿæœº) |      |
| Win7ã€Win8 | x86_64/AMD64   | Docker toolbox (ä¸€ä¸ªå·¥å…·é›†, åŒ…å«Oracle VM Virtualbox) |      |
| Mac        | x86_64/AMD64   | Docker Desktop for Mac                                |      |
|            |                |                                                       |      |
|            |                |                                                       |      |


## Docker å®‰è£…


### Linux-Ubuntu

[å¦‚ä½•åœ¨ Ubuntu 24.04 LTS ä¸Šå®‰è£… Docker - ç³»ç»Ÿæå®¢](https://www.sysgeek.cn/install-docker-ubuntu/)
```
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```
### ğŸ”§Â **ä¸€ã€å®‰è£…å‡†å¤‡**

1. **å¸è½½æ—§ç‰ˆæœ¬**ï¼ˆå¦‚å­˜åœ¨ï¼‰
    sudo apt remove docker docker-engine docker.io containerd runc -y
    sudo rm -rf /var/lib/docker /etc/docker
    
2. **å®‰è£…ä¾èµ–å·¥å…·**
    sudo apt update
    sudo apt install -y apt-transport-https ca-certificates curl gnupg lsb-release software-properties-common
---

### âš™ï¸Â **äºŒã€å®‰è£…Dockerå¼•æ“**

1. **æ·»åŠ é˜¿é‡Œäº‘é•œåƒæº**ï¼ˆå›½å†…åŠ é€Ÿï¼‰310
    # å¯¼å…¥GPGå¯†é’¥ï¼ˆé€‚é…Ubuntu 24.04ï¼‰
    curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/aliyun-docker.gpg
    
    # æ·»åŠ ä»“åº“
    echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/aliyun-docker.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
    
2. **å®‰è£…Docker**
    sudo apt update
    sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
    
3. **å¯åŠ¨å¹¶éªŒè¯**
    sudo systemctl start docker
    sudo systemctl enable docker
    sudo docker run hello-world  # æ˜¾ç¤º"Hello from Docker!"å³æˆåŠŸ
    

---

### ğŸŒÂ **ä¸‰ã€é…ç½®å›½å†…é•œåƒåŠ é€Ÿ**

1. **é€‰æ‹©é•œåƒæº**ï¼ˆæ¨èé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰
    
    |**æœåŠ¡å•†**|**åŠ é€Ÿåœ°å€**|**ç‰¹ç‚¹**|
    |---|---|---|
    |é˜¿é‡Œäº‘|`https://<ä½ çš„ID>.mirror.aliyuncs.com`|éœ€[æ³¨å†Œè·å–ä¸“å±URL]1|
    |è…¾è®¯äº‘|`https://mirror.ccs.tencentyun.com`|å¼€ç®±å³ç”¨6|
    |USTC|`https://docker.mirrors.ustc.edu.cn`|æ•™è‚²ç½‘ä¼˜åŒ–2|
    
2. **é…ç½®åŠ é€Ÿå™¨**
    sudo tee /etc/docker/daemon.json <<-'EOF'
    {
      "registry-mirrors": [
        "https://mirror.ccs.tencentyun.com",  # è…¾è®¯äº‘
        "https://docker.mirrors.ustc.edu.cn"   # ä¸­ç§‘å¤§
      ]
    }
    EOF
    
    > ğŸ’¡ å¤šé•œåƒæºå¯å¹¶è¡Œä½¿ç”¨ï¼ŒDockerä¼šè‡ªåŠ¨é€‰æ‹©æœ€å¿«èŠ‚ç‚¹48ã€‚
    
3. **é‡å¯ç”Ÿæ•ˆ**
    sudo systemctl daemon-reload
    sudo systemctl restart docker
    # éªŒè¯é…ç½®
    docker info | grep "Registry Mirrors" -A 5
    

---

### ğŸ”‘Â **å››ã€æƒé™ç®¡ç†**

1. **å…è®¸érootç”¨æˆ·æ“ä½œ**
    sudo usermod -aG docker $USER  # å½“å‰ç”¨æˆ·åŠ å…¥dockerç»„
    newgrp docker  # ç«‹å³ç”Ÿæ•ˆç»„æƒé™
    
    > âš ï¸ æ— éœ€é‡å¯ï¼Œåç»­å‘½ä»¤å¯çœç•¥`sudo`ã€‚
    

---

### ğŸ› ï¸Â **äº”ã€åç»­ä¼˜åŒ–**

1. **å®‰è£…Docker Compose**
    sudo apt install -y docker-compose-plugin
    docker compose version  # éªŒè¯å®‰è£…
    
2. **éƒ¨ç½²Portainerå¯è§†åŒ–å·¥å…·**
    docker run -d -p 9000:9000 --name portainer \
      -v /var/run/docker.sock:/var/run/docker.sock \
      -v portainer_data:/data \
      portainer/portainer-ce
    
    è®¿é—®Â `http://<æœåŠ¡å™¨IP>:9000`Â åˆå§‹åŒ–ç®¡ç†ç•Œé¢57ã€‚
<div STYLE="page-break-after: always;"></div>


## Docker åŸºç¡€å‘½ä»¤

[Docker reference | Docker Documentation -- å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/engine/reference/run/)

### å¸®åŠ©å‘½ä»¤

æŸ¥çœ‹ç›¸å…³æŒ‡ä»¤å…·ä½“ç”¨æ³•ï¼Œç‰¹åˆ«æ˜¯ docker run å‘½ä»¤ä¼šé™„å¸¦å¾ˆå¤šå‚æ•°ï¼Œå‚è€ƒæ–‡æ¡£è¯¦ç»†äº†è§£ã€‚

```shell
docker version           # æ˜¾ç¤ºdockerçš„ç‰ˆæœ¬ä¿¡æ¯
docker info              # æ˜¾ç¤ºdockerçš„ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨çš„æ•°é‡
docker `command` --help  # å‘½ä»¤çš„å…·ä½“ä½¿ç”¨è¯´æ˜
```


å¸®åŠ©æ–‡æ¡£çš„åœ°å€ï¼šhttps://docs.docker.com/reference/



### é•œåƒå‘½ä»¤

#### åˆ¶ä½œé•œåƒ

```shell
å¸¸ç”¨çš„åˆ¶ä½œæ–°é•œåƒçš„ä¸¤ç§æ–¹å¼ï¼š
1ã€åŸºäº Dockerfile æ„å»ºé•œåƒæ–‡ä»¶
2ã€ä»ä»“åº“ä¸­ä¸‹è½½ä¸€ä¸ªåŸºç¡€é•œåƒï¼Œå¯åŠ¨å®¹å™¨å¹¶å®‰è£…ä¸€äº›éœ€è¦çš„åŸºç¡€æœåŠ¡ï¼Œç„¶åä½¿ç”¨ 'docker export' å°†å®¹å™¨å¯¼å‡ºä¸ºé•œåƒæ–‡ä»¶

# åŸºäº Dockerfile æ„å»ºé•œåƒ
root@keda-PC:~# docker build --help
Usage:	docker build [OPTIONS] PATH | URL | -
Build an image from a Dockerfile
Options:
      --add-host list           Add a custom host-to-IP mapping (host:ip)
      --build-arg list          Set build-time variables
      --cache-from strings      Images to consider as cache sources
      --cgroup-parent string    Optional parent cgroup for the container
      --compress                Compress the build context using gzip
      --cpu-period int          Limit the CPU CFS (Completely Fair Scheduler) period
      --cpu-quota int           Limit the CPU CFS (Completely Fair Scheduler) quota
  -c, --cpu-shares int          CPU shares (relative weight)
      --cpuset-cpus string      CPUs in which to allow execution (0-3, 0,1)
      --cpuset-mems string      MEMs in which to allow execution (0-3, 0,1)
      --disable-content-trust   Skip image verification (default true)
  -f, --file string             Name of the Dockerfile (Default is 'PATH/Dockerfile')
      --force-rm                Always remove intermediate containers
      --iidfile string          Write the image ID to the file
      --isolation string        Container isolation technology
      --label list              Set metadata for an image
  -m, --memory bytes            Memory limit
      --memory-swap bytes       Swap limit equal to memory plus swap: '-1' to enable unlimited swap
      --network string          Set the networking mode for the RUN instructions during build (default "default")
      --no-cache                Do not use cache when building the image
      --pull                    Always attempt to pull a newer version of the image
  -q, --quiet                   Suppress the build output and print image ID on success
      --rm                      Remove intermediate containers after a successful build (default true)
      --security-opt strings    Security options
      --shm-size bytes          Size of /dev/shm
  -t, --tag list                Name and optionally a tag in the 'name:tag' format
      --target string           Set the target build stage to build.
      --ulimit ulimit           Ulimit options (default [])
root@keda-PC:~# 

# ç¤ºä¾‹ï¼šä¾æ®å½“å‰ç›®å½•çš„ Dockerfile æ„å»ºé•œåƒ kedacom/mpuaps æ ‡ç­¾ v1.0
root@keda-PC:~# docker build -t kedacom/mpuaps:v1.0 .   
```



#### æŸ¥çœ‹é•œåƒ

```shell
root@keda-PC:~# docker images --help
Usage:	docker images [OPTIONS] [REPOSITORY[:TAG]]
List images
Options:
  -a, --all             Show all images (default hides intermediate images)
      --digests         Show digests
  -f, --filter filter   Filter output based on conditions provided
      --format string   Pretty-print images using a Go template
      --no-trunc        Don't truncate output
  -q, --quiet           Only show numeric IDs
root@keda-PC:~# 
root@keda-PC:~# 
# ç¤ºä¾‹
root@keda-PC:~# docker images 
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ft_build            v3.0                8c9ea17d0635        6 months ago        2.76GB
root@keda-PC:~# 

# å­—æ®µå«ä¹‰
REPOSITORY      é•œåƒçš„ä»“åº“æº
TAG             é•œåƒçš„æ ‡ç­¾
IMAGE ID        é•œåƒçš„id
CREATED         é•œåƒçš„åˆ›å»ºæ—¶é—´
SIZE            é•œåƒå¤§å°
# å¸¸ç”¨å‚æ•°
å¯é€‰é¡¹
-a, --all      # åˆ—å‡ºæ‰€æœ‰çš„é•œåƒ
-q, --quiet    # åªæ˜¾ç¤ºé•œåƒçš„id
```



#### æœç´¢é•œåƒ(é•œåƒä»“åº“)

```shell
root@keda-PC:/home/code/lyjwin/project/MSP/40-servers/mpuaps# docker search --help
Usage:	docker search [OPTIONS] TERM
Search the Docker Hub for images
Options:
  -f, --filter filter   Filter output based on conditions provided
      --format string   Pretty-print search using a Go template
      --limit int       Max number of search results (default 25)
      --no-trunc        Don't truncate output
root@keda-PC:/home/code/lyjwin/project/MSP/40-servers/mpuaps#

# ç¤ºä¾‹ï¼šæœç´¢ starts>5000 çš„mysqlé•œåƒåŒ…
root@keda-PC:/home/code/lyjwin/project/MSP/40-servers/mpuaps# docker search mysql -f=stars=5000
NAME                DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED
mysql               MySQL is a widely used, open-source relationâ€¦   13999               [OK]                
mariadb             MariaDB Server is a high performing open souâ€¦   5340                [OK]                
```



#### ä¸‹è½½é•œåƒ(é•œåƒä»“åº“)

```shell
root@keda-PC:/home/code/lyjwin/project/MSP/40-servers/mpuaps# docker pull --help
Usage:	docker pull [OPTIONS] NAME[:TAG|@DIGEST]
Pull an image or a repository from a registry
Options:
  -a, --all-tags                Download all tagged images in the repository
      --disable-content-trust   Skip image verification (default true)
root@keda-PC:/home/code/lyjwin/project/MSP/40-servers/mpuaps# 

# ç¤ºä¾‹ï¼šä¸‹è½½ mysql é•œåƒåŒ…ï¼Œä¸æŒ‡å®šç‰ˆæœ¬ä¿¡æ¯(tag)
# å¦‚æœä¸å†™ tagï¼Œé»˜è®¤å°±æ˜¯ latest
# ç‰¹æ€§ï¼šåˆ†å±‚ä¸‹è½½ï¼ˆdocker imageçš„æ ¸å¿ƒï¼šè”åˆæ–‡ä»¶ç³»ç»Ÿï¼‰
[root@AlibabaECS ~]# docker pull mysql
Using default tag: latest
latest: Pulling from library/mysql 
bf5952930446: Pull complete
8254623a9871: Pull complete 
938e3e06dac4: Pull complete 
ea28ebf28884: Pull complete 
f3cef38785c2: Pull complete 
894f9792565a: Pull complete 
1d8a57523420: Pull complete 
6c676912929f: Pull complete 
ff39fdb566b4: Pull complete 
fff872988aba: Pull complete 
4d34e365ae68: Pull complete 
7886ee20621e: Pull complete 
Digest: sha256:c358e72e100ab493a0304bda35e6f239db2ec8c9bb836d8a427ac34307d074ed
Status: Downloaded newer image for mysql:latest
docker.io/library/mysql:latest

# ä¸‹è½½æŒ‡å®šç‰ˆæœ¬
[root@AlibabaECS ~]# docker pull mysql:5.7
5.7: Pulling from library/mysql
bf5952930446: Already exists 
8254623a9871: Already exists 
938e3e06dac4: Already exists 
ea28ebf28884: Already exists 
f3cef38785c2: Already exists 
894f9792565a: Already exists 
1d8a57523420: Already exists 
5f09bf1d31c1: Pull complete 
1b6ff254abe7: Pull complete 
74310a0bf42d: Pull complete 
d398726627fd: Pull complete 
Digest: sha256:da58f943b94721d46e87d5de208dc07302a8b13e638cd1d24285d222376d6d84
Status: Downloaded newer image for mysql:5.7
docker.io/library/mysql:5.7
```



#### åˆ é™¤é•œåƒ

```shell
# åˆ é™¤æŒ‡å®šçš„å®¹å™¨
[root@AlibabaECS ~]# docker rmi -f imageId
# åˆ é™¤å¤šä¸ªå®¹å™¨
[root@AlibabaECS ~]# docker rmi -f imageId1 imageId2 imageId3
# åˆ é™¤å…¨éƒ¨é•œåƒ
[root@AlibabaECS ~]# docker rmi -f $(docker images -aq)
```



#### å¯¼å…¥å¯¼å‡ºé•œåƒ

##### å¯¼å…¥å¯¼å‡ºé•œåƒåŒ…(save/load)

```shell
## ä¿å­˜é•œåƒæ–‡ä»¶(å°†å·²å­˜åœ¨é•œåƒå¯¼å‡ºä¸ºé•œåƒæ–‡ä»¶)
root@keda-PC:~# docker save --help
Usage:	docker save [OPTIONS] IMAGE [IMAGE...]
Save one or more images to a tar archive (streamed to STDOUT by default)
Options:
  -o, --output string   Write to a file, instead of STDOUT

# ç¤ºä¾‹ï¼šå¯¼å‡º ft_build:v3.0 é•œåƒï¼Œä¿å­˜ä¸º ubuntu20.04_arm64.tar
root@keda-PC:~# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ft_build            v3.0                8c9ea17d0635        6 months ago        2.76GB
root@keda-PC:~# 
root@keda-PC:~# docker save -o ubuntu20.04_arm64.tar 8c9ea17d0635
root@keda-PC:~# docker save -o ubuntu20.04_arm64.tar ft_build:v3.0

## è½½å…¥é•œåƒæ–‡ä»¶(è½½å…¥ 'docker save' å‘½ä»¤ä¿å­˜çš„é•œåƒæ–‡ä»¶)
root@keda-PC:~# docker load --help
Usage:	docker load [OPTIONS]
Load an image from a tar archive or STDIN
Options:
  -i, --input string   Read from tar archive file, instead of STDIN
  -q, --quiet          Suppress the load output

# ç¤ºä¾‹ï¼šè½½å…¥ 'docker save' ä¿å­˜çš„é•œåƒåŒ…
root@keda-PC:~# docker load -i ubuntu20.04_arm64.tar
root@keda-PC:~# 
# æ³¨æ„ 'docker load' è½½å…¥é•œåƒæ—¶ä¸æ”¯æŒæŒ‡å®šæ–°åç§°å’Œæ ‡ç­¾
# ç»™è½½å…¥çš„é•œåƒé‡å‘½åã€é‡æ–°æ‰“æ ‡ç­¾
root@keda-PC:~# docker tag [imageId] ubuntu20.04_ft:test
```

##### å¯¼å…¥å¯¼å‡ºå®¹å™¨åŒ…(export/import)

```shell
## å¯¼å‡ºå®¹å™¨(å°†æ­£åœ¨è¿è¡Œçš„å®¹å™¨å¯¼å‡ºä¸ºä¸€ä¸ªé•œåƒæ–‡ä»¶)
root@keda-PC:~# docker export --help
Usage:  docker export [OPTIONS] CONTAINER
Export a container's filesystem as a tar archive
Options:
  -o, --output string   Write to a file, instead of STDOUT
 

## å¯¼å…¥å®¹å™¨(å¯¼å…¥ä½¿ç”¨ 'docker export' å¯¼å‡ºçš„é•œåƒåŒ…)
root@keda-PC:~# docker import --help
Usage:  docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]]
Import the contents from a tarball to create a filesystem image
Options:
  -c, --change list       Apply Dockerfile instruction to the created image
  -m, --message string    Set commit message for imported image
      --platform string   Set platform if server is multi-platform capable

# ç¤ºä¾‹ï¼šå¯¼å‡ºå®¹å™¨ ca47a4ea0b84
root@keda-PC:~# docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
ca47a4ea0b84        8c9ea17d0635        "/bin/bash"         4 days ago          Up 2 hours                              ubuntu20.04_ft
root@keda-PC:~# 
root@keda-PC:~# docker export 
root@keda-PC:~#
```

##### åŒºåˆ«

```shell
## æ³¨æ„ 'docker save' å’Œ 'docker export' åŒºåˆ«
docker save   ä¿å­˜çš„æ˜¯é•œåƒï¼ˆimageï¼‰ï¼Œdocker export ä¿å­˜çš„æ˜¯å®¹å™¨ï¼ˆcontainerï¼‰
docker load   ç”¨æ¥è½½å…¥é•œåƒåŒ…ï¼Œdocker import ç”¨æ¥è½½å…¥å®¹å™¨åŒ…ï¼Œä½†ä¸¤è€…éƒ½ä¼šæ¢å¤ä¸ºé•œåƒ
docker load   ä¸èƒ½å¯¹è½½å…¥çš„é•œåƒé‡å‘½åï¼Œè€Œ docker import å¯ä»¥ä¸ºé•œåƒæŒ‡å®šæ–°åç§°
docker export å¯¼å‡ºçš„é•œåƒæ–‡ä»¶ size å°äº docker save ä¿å­˜çš„é•œåƒ
docker save   ä¿å­˜çš„é•œåƒæ–‡ä»¶æ²¡æœ‰ä¸¢å¤±é•œåƒçš„å†å²ï¼Œå¯ä»¥å›æ»šåˆ°ä¹‹å‰çš„å±‚ï¼ˆlayerï¼‰ã€‚ï¼ˆæŸ¥çœ‹æ–¹å¼ï¼šdocker images --treeï¼‰
docker export å¯¼å‡ºçš„é•œåƒæ–‡ä»¶é‡æ–°å¯¼å…¥æ—¶ä¼šä¸¢å¤±é•œåƒæ‰€æœ‰çš„å†å²ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œå›æ»šæ“ä½œï¼ˆdocker tag ï¼‰


## ä½¿ç”¨ 'docker import' å¯¼å…¥ 'docker save' ä¿å­˜çš„é•œåƒåŒ…ï¼Œå¯åŠ¨å®¹å™¨æ—¶ä¼šæŠ¥é”™
docker: Error response from daemon: oci runtime error: container_linux.go:247: starting container process caused "exec: \"/bin/bash\": stat /bin/bash: no such file or directory".
```



### å®¹å™¨å‘½ä»¤

#### å®¹å™¨å¯åŠ¨

```shell
# docker run å‘½ä»¤æ¯”è¾ƒå¤æ‚ï¼Œè¯¦æƒ…å‚è€ƒå®˜æ–¹æ–‡æ¡£ https://docs.docker.com/engine/reference/run/
# å¸¸ç”¨å‚æ•°
--name="DockerName"è®¾ç½®å®¹å™¨åç§°(ç”¨æ¥åŒºåˆ†ä½¿ç”¨åŒä¸€ä¸ªé•œåƒå¯åŠ¨çš„å¤šä¸ªå®¹å™¨)
-d                 åå°æ–¹å¼è¿è¡Œ
-i                 ä½¿ç”¨äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ã€‚é€šå¸¸ä¸ -t åŒæ—¶ç”¨
-t                 ä¸ºå®¹å™¨åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ã€‚é€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨
-p                 æŒ‡å®šå®¹å™¨çš„ç«¯å£(å°å†™p)
                                -p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£     ä¾‹ï¼š-p 8080:8080
                                -p IP:ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£  ä¾‹ï¼š-p 10.67.76.7:8080:8080
                                -p å®¹å™¨ç«¯å£:            ä¾‹ï¼š-p 8080
-P                 éšæœºåˆ†é…ç«¯å£(å¤§å†™P)

# ç¤ºä¾‹ï¼šåœ¨åå°è¿è¡Œä¸€ä¸ªå®¹å™¨å®ä¾‹ï¼Œå¯äº¤äº’ã€è‡ªåŠ¨é‡å¯ã€å…±äº«ä¸»æœºç½‘ç»œã€å®¹å™¨å†…æ‹¥æœ‰rootæƒé™ã€æŒ‡å®šä¸¤ä¸ªæŒ‚åœ¨è·¯å¾„ã€è‡ªå®šå®¹å™¨å
root@ubuntu-Vostro-3268:~# docker run -itd --restart=always --net=host --privileged=true -v /opt:/opt -v /mnt:/mnt:shared --name=1_centos7_amd64  centos7.4_64 /bin/bash
55909b0901ddb302b655b1237bb3f6c463fe0e02bd526319a4f91f44b742ab84
root@ubuntu-Vostro-3268:~# docker ps -a
CONTAINER ID   IMAGE          COMMAND       CREATED          STATUS                    PORTS     NAMES
55909b0901dd   centos7.4_64   "/bin/bash"   32 seconds ago   Up 31 seconds                       1_centos7_amd64

# æµ‹è¯•è¿›å…¥å®¹å™¨å†…
root@ubuntu-Vostro-3268:~# docker exec -it 55909b0901dd /bin/bash
bash-4.2# cd /home/
bash-4.2# ls
bash-4.2# exit
root@ubuntu-Vostro-3268:~#

# é€€å‡ºå®¹å™¨
exit                 # åœæ­¢å¹¶é€€å‡ºå®¹å™¨
Ctrl + P + Q         # ä»…é€€å‡ºå½“å‰å®¹å™¨

# å¸®åŠ©æ–‡æ¡£
root@keda-PC:~# docker run --help
Usage:	docker run [OPTIONS] IMAGE [COMMAND] [ARG...]
Run a command in a new container
Options:
      --add-host list                  Add a custom host-to-IP mapping (host:ip)
  -a, --attach list                    Attach to STDIN, STDOUT or STDERR
      --blkio-weight uint16            Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)
      --blkio-weight-device list       Block IO weight (relative device weight) (default [])
      --cap-add list                   Add Linux capabilities
      --cap-drop list                  Drop Linux capabilities
      --cgroup-parent string           Optional parent cgroup for the container
      --cidfile string                 Write the container ID to the file
      --cpu-period int                 Limit CPU CFS (Completely Fair Scheduler) period
      --cpu-quota int                  Limit CPU CFS (Completely Fair Scheduler) quota
      --cpu-rt-period int              Limit CPU real-time period in microseconds
      --cpu-rt-runtime int             Limit CPU real-time runtime in microseconds
  -c, --cpu-shares int                 CPU shares (relative weight)
      --cpus decimal                   Number of CPUs
      --cpuset-cpus string             CPUs in which to allow execution (0-3, 0,1)
      --cpuset-mems string             MEMs in which to allow execution (0-3, 0,1)
  -d, --detach                         Run container in background and print container ID
      --detach-keys string             Override the key sequence for detaching a container
      --device list                    Add a host device to the container
      --device-cgroup-rule list        Add a rule to the cgroup allowed devices list
      --device-read-bps list           Limit read rate (bytes per second) from a device (default [])
      --device-read-iops list          Limit read rate (IO per second) from a device (default [])
      --device-write-bps list          Limit write rate (bytes per second) to a device (default [])
      --device-write-iops list         Limit write rate (IO per second) to a device (default [])
      --disable-content-trust          Skip image verification (default true)
      --dns list                       Set custom DNS servers
      --dns-option list                Set DNS options
      --dns-search list                Set custom DNS search domains
      --entrypoint string              Overwrite the default ENTRYPOINT of the image
  -e, --env list                       Set environment variables
      --env-file list                  Read in a file of environment variables
      --expose list                    Expose a port or a range of ports
      --group-add list                 Add additional groups to join
      --health-cmd string              Command to run to check health
      --health-interval duration       Time between running the check (ms|s|m|h) (default 0s)
      --health-retries int             Consecutive failures needed to report unhealthy
      --health-start-period duration   Start period for the container to initialize before starting health-retries countdown (ms|s|m|h) (default 0s)
      --health-timeout duration        Maximum time to allow one check to run (ms|s|m|h) (default 0s)
      --help                           Print usage
  -h, --hostname string                Container host name
      --init                           Run an init inside the container that forwards signals and reaps processes
  -i, --interactive                    Keep STDIN open even if not attached
      --ip string                      IPv4 address (e.g., 172.30.100.104)
      --ip6 string                     IPv6 address (e.g., 2001:db8::33)
      --ipc string                     IPC mode to use
      --isolation string               Container isolation technology
      --kernel-memory bytes            Kernel memory limit
  -l, --label list                     Set meta data on a container
      --label-file list                Read in a line delimited file of labels
      --link list                      Add link to another container
      --link-local-ip list             Container IPv4/IPv6 link-local addresses
      --log-driver string              Logging driver for the container
      --log-opt list                   Log driver options
      --mac-address string             Container MAC address (e.g., 92:d0:c6:0a:29:33)
  -m, --memory bytes                   Memory limit
      --memory-reservation bytes       Memory soft limit
      --memory-swap bytes              Swap limit equal to memory plus swap: '-1' to enable unlimited swap
      --memory-swappiness int          Tune container memory swappiness (0 to 100) (default -1)
      --mount mount                    Attach a filesystem mount to the container
      --name string                    Assign a name to the container
      --network string                 Connect a container to a network (default "default")
      --network-alias list             Add network-scoped alias for the container
      --no-healthcheck                 Disable any container-specified HEALTHCHECK
      --oom-kill-disable               Disable OOM Killer
      --oom-score-adj int              Tune host's OOM preferences (-1000 to 1000)
      --pid string                     PID namespace to use
      --pids-limit int                 Tune container pids limit (set -1 for unlimited)
      --privileged                     Give extended privileges to this container
  -p, --publish list                   Publish a container's port(s) to the host
  -P, --publish-all                    Publish all exposed ports to random ports
      --read-only                      Mount the container's root filesystem as read only
      --restart string                 Restart policy to apply when a container exits (default "no")
      --rm                             Automatically remove the container when it exits
      --runtime string                 Runtime to use for this container
      --security-opt list              Security Options
      --shm-size bytes                 Size of /dev/shm
      --sig-proxy                      Proxy received signals to the process (default true)
      --stop-signal string             Signal to stop a container (default "SIGTERM")
      --stop-timeout int               Timeout (in seconds) to stop a container
      --storage-opt list               Storage driver options for the container
      --sysctl map                     Sysctl options (default map[])
      --tmpfs list                     Mount a tmpfs directory
  -t, --tty                            Allocate a pseudo-TTY
      --ulimit ulimit                  Ulimit options (default [])
  -u, --user string                    Username or UID (format: <name|uid>[:<group|gid>])
      --userns string                  User namespace to use
      --uts string                     UTS namespace to use
  -v, --volume list                    Bind mount a volume
      --volume-driver string           Optional volume driver for the container
      --volumes-from list              Mount volumes from the specified container(s)
  -w, --workdir string                 Working directory inside the container
root@keda-PC:~# 
```



#### è¿›å…¥å®¹å™¨

```shell
# è¿›å…¥å®¹å™¨åå¼€å¯ä¸€ä¸ªæ–°çš„ä¼ªç»ˆç«¯(å¸¸ç”¨)
docker exec 
docker exec -it f8e46d4885b1 /bin/sh

# è¿›å…¥å®¹å™¨æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„ç»ˆç«¯(tty)
# å½“å¤šä¸ªçª—å£åŒæ—¶ä½¿ç”¨è¯¥å‘½ä»¤è¿›å…¥è¯¥å®¹å™¨æ—¶ï¼Œæ‰€æœ‰çš„çª—å£éƒ½ä¼šåŒæ­¥æ˜¾ç¤ºã€‚å¦‚æœæœ‰ä¸€ä¸ªçª—å£é˜»å¡äº†ï¼Œé‚£ä¹ˆå…¶ä»–çª—å£ä¹Ÿæ— æ³•å†è¿›è¡Œæ“ä½œã€‚
# æ‰§è¡Œ Ctrl+q ä¼šåœæ­¢å®¹å™¨(å¯èƒ½åˆ«äººä¹Ÿåœ¨ç”¨)
docker attach
docker attach f8e46d4885b1

# å¸®åŠ©æ–‡æ¡£
root@keda-PC:~# docker exec --help
Usage:	docker exec [OPTIONS] CONTAINER COMMAND [ARG...]
Run a command in a running container
Options:
  -d, --detach               Detached mode: run command in the background
      --detach-keys string   Override the key sequence for detaching a container
  -e, --env list             Set environment variables
  -i, --interactive          Keep STDIN open even if not attached
      --privileged           Give extended privileges to the command
  -t, --tty                  Allocate a pseudo-TTY
  -u, --user string          Username or UID (format: <name|uid>[:<group|gid>])
  -w, --workdir string       Working directory inside the container
root@keda-PC:~# 

root@keda-PC:~# docker attach --help
Usage:	docker attach [OPTIONS] CONTAINER
Attach local standard input, output, and error streams to a running container
Options:
      --detach-keys string   Override the key sequence for detaching a container
      --no-stdin             Do not attach STDIN
      --sig-proxy            Proxy all received signals to the process (default true)
root@keda-PC:~# 
```





#### åˆ—å‡ºæ‰€æœ‰çš„è¿è¡Œçš„å®¹å™¨

```shell
docker ps `å‚æ•°`		 # åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
-a       # åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨+å¸¦å‡ºå†å²è¿è¡Œè¿‡çš„å®¹å™¨
-n=?     # æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨
-q       # åªæ˜¾ç¤ºå®¹å™¨çš„ç¼–å·
```


#### åˆ é™¤å®¹å™¨

```shell
docker rm å®¹å™¨id                  # åˆ é™¤æŒ‡å®šå®¹å™¨ï¼Œä¸èƒ½åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œå¦‚æœè¦å¼ºåˆ¶åˆ é™¤ rm -f
docker rm -f $(docker ps -aq)    # åˆ é™¤æ‰€æœ‰çš„å®¹å™¨
docker ps -aq|xargs docker rm    # åˆ é™¤æ‰€æœ‰çš„å®¹å™¨

#å¯åŠ¨å’Œåœæ­¢å®¹å™¨çš„æ“ä½œ
docker start å®¹å™¨id        # å¯åŠ¨å®¹å™¨
docker restart å®¹å™¨id      # é‡å¯å®¹å™¨
docker stop å®¹å™¨id         # åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
docker kill å®¹å™¨id         # å¼ºåˆ¶åœæ­¢å½“å‰å®¹å™¨
```

#### æŸ¥çœ‹å®¹å™¨æ—¥å¿—

```shell
#docker logs -f -t --tail n å®¹å™¨ID
[root@AlibabaECS /]# docker run -d centos /bin/sh -c "while true;do echo kuangshen;sleep 1;done"
-tf                # æ˜¾ç¤ºæ—¥å¿—
--tail number      # è¦æ˜¾ç¤ºçš„æ—¥å¿—æ¡æ•°

[root@AlibabaECS /]# docker logs -ft --tail 100 f1178d5b0bd8
```



#### æŸ¥çœ‹å®¹å™¨ä¸­çš„è¿›ç¨‹ä¿¡æ¯

docker top å®¹å™¨id

```shell
root@ubuntu-Vostro-3268:/home# docker top 244d50e7bc40
UID           PID                 PPID                C                   STIME               TTY                 TIME             CMD
root          20474               20444               0                   4æœˆ26                pts/0               00:00:00        /bin/sh
```



#### æŸ¥çœ‹å®¹å™¨ä¿¡æ¯

```shell
[root@AlibabaECS /]# docker inspect f1178d5b0bd8 
[
    {
        "Id": "f1178d5b0bd8eea4e0734056c03b35da8a829390d7000d90f863f56fe59af2a3",
        "Created": "2020-08-31T05:10:13.714768846Z",
        "Path": "/bin/sh",
        "Args": [
            "-c",
            "while true;do echo kuangshen;sleep 1;done"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 21626,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2020-08-31T05:10:13.994851078Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:0d120b6ccaa8c5e149176798b3501d4dd1885f961922497cd0abef155c869566",
        "ResolvConfPath": "/var/lib/docker/containers/f1178d5b0bd8eea4e0734056c03b35da8a829390d7000d90f863f56fe59af2a3/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/f1178d5b0bd8eea4e0734056c03b35da8a829390d7000d90f863f56fe59af2a3/hostname",
        "HostsPath": "/var/lib/docker/containers/f1178d5b0bd8eea4e0734056c03b35da8a829390d7000d90f863f56fe59af2a3/hosts",
        "LogPath": "/var/lib/docker/containers/f1178d5b0bd8eea4e0734056c03b35da8a829390d7000d90f863f56fe59af2a3/f1178d5b0bd8eea4e0734056c03b35da8a829390d7000d90f863f56fe59af2a3-json.log",
        "Name": "/stupefied_colden",
        "RestartCount": 0,
        "Driver": "overlay2",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "default",
            "PortBindings": {},
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "CapAdd": null,
            "CapDrop": null,
            "Capabilities": null,
            "Dns": [],
            "DnsOptions": [],
            "DnsSearch": [],
            "ExtraHosts": null,
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "ConsoleSize": [
                0,
                0
            ],
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": [],
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": [],
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "KernelMemory": 0,
            "KernelMemoryTCP": 0,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": false,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/00a62ec6bd23d1b97f6525f3617759eab6a0d3f283aee8b3591f5e2dbd1d916f-init/diff:/var/lib/docker/overlay2/f56573c4e87525abbd1aa5e97f8553016e5b63c6d1773169e87e0b59afc5d845/diff",
                "MergedDir": "/var/lib/docker/overlay2/00a62ec6bd23d1b97f6525f3617759eab6a0d3f283aee8b3591f5e2dbd1d916f/merged",
                "UpperDir": "/var/lib/docker/overlay2/00a62ec6bd23d1b97f6525f3617759eab6a0d3f283aee8b3591f5e2dbd1d916f/diff",
                "WorkDir": "/var/lib/docker/overlay2/00a62ec6bd23d1b97f6525f3617759eab6a0d3f283aee8b3591f5e2dbd1d916f/work"
            },
            "Name": "overlay2"
        },
        "Mounts": [],
        "Config": {
            "Hostname": "f1178d5b0bd8",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
            ],
            "Cmd": [
                "/bin/sh",
                "-c",
                "while true;do echo kuangshen;sleep 1;done"
            ],
            "Image": "centos",
            "Volumes": null,
            "WorkingDir": "",
            "Entrypoint": null,
            "OnBuild": null,
            "Labels": {
                "org.label-schema.build-date": "20200809",
                "org.label-schema.license": "GPLv2",
                "org.label-schema.name": "CentOS Base Image",
                "org.label-schema.schema-version": "1.0",
                "org.label-schema.vendor": "CentOS"
            }
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "d83e7bbffe1ec2f7d31fa4887e986b5e10d0ce83a1a2d2e447617511f3fe71d3",
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "Ports": {},
            "SandboxKey": "/var/run/docker/netns/d83e7bbffe1e",
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "310a86df2f690f9358063ad5ac71ec98eb16a7eab51e13f0e8f2b9ebe5239ea9",
            "Gateway": "172.17.0.1",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "172.17.0.2",
            "IPPrefixLen": 16,
            "IPv6Gateway": "",
            "MacAddress": "02:42:ac:11:00:02",
            "Networks": {
                "bridge": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": null,
                    "NetworkID": "04038c2f1d641f91c97253ba1e8dfc890f6a9846ba6cb7ea66235079d138c319",
                    "EndpointID": "310a86df2f690f9358063ad5ac71ec98eb16a7eab51e13f0e8f2b9ebe5239ea9",
                    "Gateway": "172.17.0.1",
                    "IPAddress": "172.17.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "MacAddress": "02:42:ac:11:00:02",
                    "DriverOpts": null
                }
            }
        }
    }
]
```



#### æŸ¥çœ‹dockerçŠ¶æ€

```shell
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker stats

root@keda-PC:~# docker stats --help
Usage:	docker stats [OPTIONS] [CONTAINER...]
Display a live stream of container(s) resource usage statistics
Options:
  -a, --all             Show all containers (default shows just running)
      --format string   Pretty-print images using a Go template
      --no-stream       Disable streaming stats and only pull the first result
      --no-trunc        Do not truncate output
root@keda-PC:~# 
```

â€‹       

#### å®¹å™¨è‡ªå¯åŠ¨

```shell
# è¿è¡Œæ—¶æŒ‡å®š restart å‚æ•°è®¾ç½®è‡ªå¯åŠ¨
docke run --restart=always
                    no         - é€€å‡ºæ—¶ä¸é‡å¯(default)
                    on-failure - åªæœ‰éæ­£å¸¸é€€å‡ºæ—¶é‡å¯(é€€å‡ºçŠ¶æ€ç é0)
                    always     - æ€»æ˜¯é‡å¯


# å®ä¾‹ï¼š
docker run -itd --restart=always --net=host --privileged -v /opt:/opt -v /mnt:/mnt:shared --name centos7_64  centos7.4_64 /bin/bash
```



#### å®¹å™¨æ›´æ–°é…ç½®

[Docker updateå‘½ä»¤ä½¿ç”¨](https://www.lwhweb.com/posts/26195/)

docker update


### è¿›é˜¶å‘½ä»¤

#### å®¹å™¨æ•°æ®å·(æ•°æ®æŒä¹…åŒ–)

https://docs.docker.com/storage/volumes/

å®¹å™¨å·æŒ‚è½½ï¼š åŒ¿åæŒ‚è½½ã€å…·åæŒ‚è½½ã€æŒ‡å®šè·¯å¾„æŒ‚è½½
æ‰€æœ‰çš„dockerå®¹å™¨å†…çš„å·ï¼Œæ²¡æœ‰æŒ‡å®šå®¿ä¸»æœºç›®å½•çš„æƒ…å†µä¸‹éƒ½æ˜¯åœ¨/var/lib/docker/volumes/xxxx/_dataä¸‹ï¼›

-v å®¹å™¨å†…è·¯å¾„			               # åŒ¿åæŒ‚è½½
-v å·åï¼šå®¹å™¨å†…è·¯å¾„		        # å…·åæŒ‚è½½ 
-v å®¿ä¸»æœºè·¯å¾„ï¼šå®¹å™¨å†…è·¯å¾„     # æŒ‡å®šè·¯å¾„æŒ‚è½½(docker volume lsæŸ¥çœ‹ä¸åˆ°çš„)

å®¹å™¨å·æŒ‚è½½æƒé™å’ŒæŒ‚è½½æ¨¡å¼
å½“ä½¿ç”¨systemdç®¡ç†Dockerå®ˆæŠ¤ç¨‹åºçš„å¯åŠ¨å’Œåœæ­¢æ—¶ï¼Œåœ¨systemdå•å…ƒæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªé€‰é¡¹å¯ä»¥æ§åˆ¶Dockerå®ˆæŠ¤ç¨‹åºæœ¬èº«çš„è£…è½½ä¼ æ’­ï¼Œç§°ä¸ºMountFlagsã€‚æ­¤è®¾ç½®çš„å€¼å¯èƒ½ä¼šå¯¼è‡´Dockerçœ‹ä¸åˆ°åœ¨è£…è½½ç‚¹ä¸Šæ‰€åšçš„è£…è½½ä¼ æ’­æ›´æ”¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ­¤å€¼ä¸ºslaveï¼Œåˆ™å¯èƒ½æ— æ³•åœ¨å·ä¸Šä½¿ç”¨å…±äº«æˆ–rsharedä¼ æ’­ã€‚

dockerç»‘å®šæ•°æ®å·é»˜è®¤æ¨¡å¼æ˜¯[private]. ä½¿ç”¨æŒ‚è½½ç›®å½•åšå®¹å™¨çš„æ•°æ®å·, åœ¨å®¿ä¸»æœºä¸Šè¿›è¡Œmount/umountæ“ä½œä¸èƒ½åŒæ­¥åˆ°å®¹å™¨å†…
éœ€è¦åœ¨å®¹å™¨è¿›è¡Œç»‘å®šæŒ‚è½½å‰, åœ¨å®¿ä¸»æœºçš„æŒ‡å®šç›®å½•ä¸Š, å…ˆæŒ‚è½½è¿œç¨‹ç›®å½•.
å®¹å™¨å¯åŠ¨æ—¶, -v ç»‘å®šæ•°æ®å·è®¾ç½®æ¨¡å¼ä½`shared`

```shell
--volume=[host-src:]container-dest[:<options>]

#options
ro                 #readonly  åªè¯»
rw                 #readwrite å¯è¯»å¯å†™(é»˜è®¤)

#å…±ç”¨å…¶ä»–å®¹å™¨çš„æ•°æ®å·
--volumes-from=
```



#### å®¹å™¨tmpfs 

![volumes on the Docker host](https://docs.docker.com/storage/images/types-of-mounts-volume.png)

The example below mounts an empty tmpfs into the container with the `rw`, `noexec`, `nosuid`, and `size=65536k` options.

```shell
$ docker run -d --tmpfs /run:rw,noexec,nosuid,size=65536k my_image
```




#### Dockerç½‘ç»œ

[Dockeré«˜çº§ç½‘ç»œé…ç½®_ç¥¯minçš„åšå®¢-CSDNåšå®¢_docker networké…ç½®](https://blog.csdn.net/qq_44251046/article/details/90695178?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_baidulandingword-0&spm=1001.2101.3001.4242)

[ Dockerç½‘ç»œè¯¦è§£â€”â€”åŸç†ç¯‡_meltsnowçš„åšå®¢-CSDNåšå®¢_docker ç½‘ç»œ](https://blog.csdn.net/meltsnow/article/details/94490994?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujs&dist_request_id=1332048.22019.16195228904933879&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujs)

å®‰è£…Dockeræ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»ºä¸‰ä¸ªç½‘ç»œï¼Œbridgeï¼ˆåˆ›å»ºå®¹å™¨é»˜è®¤è¿æ¥åˆ°æ­¤ç½‘ç»œï¼‰ã€ none ã€host
ä½¿ç”¨docker runåˆ›å»ºDockerå®¹å™¨æ—¶ï¼Œå¯ä»¥ç”¨ --net é€‰é¡¹æŒ‡å®šå®¹å™¨çš„ç½‘ç»œæ¨¡å¼ï¼ŒDockerå¯ä»¥æœ‰ä»¥ä¸‹4ç§ç½‘ç»œæ¨¡å¼ï¼š

hostæ¨¡å¼ï¼š        ä½¿ç”¨ --net=host æŒ‡å®šã€‚
noneæ¨¡å¼ï¼š       ä½¿ç”¨ --net=none æŒ‡å®šã€‚
bridgeæ¨¡å¼ï¼š     ä½¿ç”¨ --net=bridge æŒ‡å®šï¼Œé»˜è®¤è®¾ç½®ã€‚
containeræ¨¡å¼ï¼šä½¿ç”¨ --net=container:NAME_or_ID æŒ‡å®šã€‚

| ç½‘ç»œæ¨¡å¼  | ç®€ä»‹                                                         |
| --------- | ------------------------------------------------------------ |
| Host      | å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„IPç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„IPå’Œç«¯å£ |
| Bridge    | æ­¤æ¨¡å¼ä¼šä¸ºæ¯ä¸€ä¸ªå®¹å™¨åˆ†é…ã€è®¾ç½®IPç­‰ï¼Œå¹¶å°†å®¹å™¨è¿æ¥åˆ°ä¸€ä¸ªdocker0è™šæ‹Ÿç½‘æ¡¥ï¼Œé€šè¿‡docker0ç½‘æ¡¥ä»¥åŠIptables natè¡¨é…ç½®ä¸å®¿ä¸»æœºé€šä¿¡ |
| None      | è¯¥æ¨¡å¼å…³é—­äº†å®¹å™¨çš„ç½‘ç»œåŠŸèƒ½                                   |
| Container | åˆ›å»ºçš„å®¹å™¨ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„IPï¼Œè€Œæ˜¯å’Œä¸€ä¸ªæŒ‡å®šçš„å®¹å™¨å…±äº«IPã€ç«¯å£èŒƒå›´ |


Dockerä½¿ç”¨äº†Linuxçš„NamespacesæŠ€æœ¯æ¥è¿›è¡Œèµ„æºéš”ç¦»ï¼Œå¦‚PID Namespaceéš”ç¦»è¿›ç¨‹ï¼ŒMount Namespaceéš”ç¦»æ–‡ä»¶ç³»ç»Ÿï¼ŒNetwork Namespaceéš”ç¦»ç½‘ç»œç­‰ã€‚

ä¸€ä¸ªNetwork Namespaceæä¾›äº†ä¸€ä»½ç‹¬ç«‹çš„ç½‘ç»œç¯å¢ƒï¼ŒåŒ…æ‹¬ç½‘å¡ã€è·¯ç”±ã€Iptableè§„åˆ™ç­‰éƒ½ä¸å…¶ä»–çš„Network Namespaceéš”ç¦»ã€‚ä¸€ä¸ªDockerå®¹å™¨ä¸€èˆ¬ä¼šåˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„Network Namespaceã€‚ä½†å¦‚æœå¯åŠ¨å®¹å™¨çš„æ—¶å€™ä½¿ç”¨hostæ¨¡å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¹å™¨å°†ä¸ä¼šè·å¾—ä¸€ä¸ªç‹¬ç«‹çš„Network Namespaceï¼Œè€Œæ˜¯å’Œå®¿ä¸»æœºå…±ç”¨ä¸€ä¸ªNetwork Namespaceã€‚å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„IPç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„IPå’Œç«¯å£ã€‚

```shell
#docker0ç‰¹ç‚¹ï¼šé»˜è®¤ï¼ŒåŸŸåä¸èƒ½è®¿é—®ï¼Œ--linkå¯ä»¥æ‰“é€šè¿æ¥

#è‡ªå®šä¹‰ç½‘ç»œ
#å¯ä»¥è‡ªå®šä¹‰ç½‘æ¡¥
#è¿›ä¸€æ­¥æ§åˆ¶å“ªäº›å®¹å™¨ä¹‹é—´å¯ä»¥é€šè®¯
--driver bridge 
--subnet 192.168.0.0/16    å­ç½‘
--gateway 192.168.0.1      ç½‘å…³

[root@AlibabaECS ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet
dd7c8522864cb87c332d355ccd837d94433f8f10d58695ecf278f8bcfc88c1fc
[root@AlibabaECS ~]# docker network ls
NETWORK ID          NAME                DRIVER              SCOPE
04038c2f1d64        bridge              bridge              local
81476375c43d        host                host                local
dd7c8522864c        mynet               bridge              local
64ba38c2cb2b        none                null                local

[root@AlibabaECS ~]# docker run -d -P --name tomcat-net-01 --net mynet tomcat
1de6f5994a480160d932de239b104b366ebd5b954e740a5ab8c0d5aeea8f5ba5
[root@AlibabaECS ~]# docker run -d -P --name tomcat-net-02 --net mynet tomcat
f26916a49e5ee239aee23584020e0d23d53d2e644d5cb5155d831edc0803d957
[root@AlibabaECS ~]# docker network inspect mynet
[
    {
        "Name": "mynet",
        "Id": "dd7c8522864cb87c332d355ccd837d94433f8f10d58695ecf278f8bcfc88c1fc",
        "Created": "2020-09-05T12:43:54.847233062+08:00",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": {
            "Driver": "default",
            "Options": {},
            "Config": [
                {
                    "Subnet": "192.168.0.0/16",
                    "Gateway": "192.168.0.1"
                }
            ]
        },
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": {
            "Network": ""
        },
        "ConfigOnly": false,
        "Containers": {
            "1de6f5994a480160d932de239b104b366ebd5b954e740a5ab8c0d5aeea8f5ba5": {
                "Name": "tomcat-net-01",
                "EndpointID": "c308999d4e51ed9e5975f3b4f3c1d468bfb08d93de7561d55062db055f44ef18",
                "MacAddress": "02:42:c0:a8:00:02",
                "IPv4Address": "192.168.0.2/16",
                "IPv6Address": ""
            },
            "f26916a49e5ee239aee23584020e0d23d53d2e644d5cb5155d831edc0803d957": {
                "Name": "tomcat-net-02",
                "EndpointID": "8d9dbdd6ca119559ef4f1dd82a36e0d279c0b8284fe19f36c6d992047937a764",
                "MacAddress": "02:42:c0:a8:00:03",
                "IPv4Address": "192.168.0.3/16",
                "IPv6Address": ""
            }
        },
        "Options": {},
        "Labels": {}
    }
]
```

æœ‰æ—¶Dockerä¼šè¿è¡Œä¸€äº›ç½‘ç»œæœåŠ¡ï¼Œå¦‚æœDockerä½¿ç”¨çš„å†…éƒ¨ç½‘ç»œï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»æœ¬æœºä»¥å¤–çš„åœ°æ–¹å°±æ²¡æ³•è®¿é—®æœåŠ¡äº†ã€‚Dockeræä¾›äº†ç«¯å£æ˜ å°„çš„åŠŸèƒ½ï¼Œå°†æœ¬æœºçš„æŸä¸ªç«¯å£æ˜ å°„åˆ°å®¹å™¨å†…éƒ¨å¼€æ”¾çš„ç«¯å£ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—®æœ¬æœºçš„æŒ‡å®šç«¯å£å³å¯è®¿é—®å®¹å™¨å†…éƒ¨æœåŠ¡äº†ã€‚å¯ä»¥ä½¿ç”¨-Pæˆ–è€…-pè¿›è¡Œç«¯å£æ˜ å°„ã€‚

ä½¿ç”¨ -P æ—¶ï¼ŒDocker ä¼šéšæœºæ˜ å°„ä¸€ä¸ªç«¯å£åˆ°å†…éƒ¨å®¹å™¨å¼€æ”¾çš„ç½‘ç»œç«¯å£ã€‚
ä½¿ç”¨ -p æ—¶ï¼Œå¯ä»¥æŒ‡å®šè¦æ˜ å°„çš„ç«¯å£ï¼Œåœ¨ä¸€ä¸ªæŒ‡å®šç«¯å£ä¸Šåªå¯ä»¥ç»‘å®šä¸€ä¸ªå®¹å™¨å®¹å™¨äº’è”
é»˜è®¤æƒ…å†µä¸‹ï¼Œå„å®¹å™¨ä¹‹é—´æ˜¯äº’é€šçš„ã€‚å½“ä½¿ç”¨é€‰é¡¹-icc=falseé‡å¯dockeråï¼Œå®¹å™¨ä¹‹é—´å°±äº’ç›¸éš”ç¦»äº†ã€‚å®¹å™¨çš„è®¿é—®æ§åˆ¶ï¼Œä¸»è¦é€šè¿‡ Linux ä¸Šçš„ iptables é˜²ç«å¢™æ¥è¿›è¡Œç®¡ç†å’Œå®ç°ã€‚

å¯ä»¥é€šè¿‡-link name:aliaså‘½ä»¤è¿æ¥æŒ‡å®šå®¹å™¨ï¼ŒDocker åœ¨ä¸¤ä¸ªäº’è”çš„å®¹å™¨ä¹‹é—´åˆ›å»ºäº†ä¸€ä¸ªå®‰å…¨éš§é“ï¼Œè€Œä¸”ä¸ç”¨æ˜ å°„å®ƒä»¬çš„ç«¯å£åˆ°å®¿ä¸»ä¸»æœºä¸Šï¼Œä»è€Œé¿å…äº†æš´éœ²æ•°æ®åº“ç«¯å£åˆ°å¤–éƒ¨ç½‘ç»œä¸Šã€‚

è·¨å®¿ä¸»æœºå®¹å™¨é—´çš„é€šè®¯ä¹‹macvlan
è·¨å®¿ä¸»æœºå®¹å™¨é—´çš„é€šè®¯ä¹‹overlay



#### Dockerèµ„æºæ§åˆ¶

[Runtime options with Memory, CPUs, and GPUs | Docker Documentation](https://docs.docker.com/config/containers/resource_constraints/)
[ä½¿ç”¨ docker å¯¹å®¹å™¨èµ„æºè¿›è¡Œé™åˆ¶ - DockOne.io](http://dockone.io/article/2569)
[Index of /doc/Documentation/cgroup-v1/ (kernel.org)](https://www.kernel.org/doc/Documentation/cgroup-v1/)
[Dockerèµ„æºç®¡ç†æ¢ç§˜ï¼šDockerèƒŒåçš„å†…æ ¸Cgroupsæœºåˆ¶-InfoQ](https://www.infoq.cn/article/docker-resource-management-cgroups/)

Dockerä½¿ç”¨å†…æ ¸çš„ namespace æ¥åšå®¹å™¨ä¹‹é—´çš„éš”ç¦»ï¼Œä½¿ç”¨å†…æ ¸çš„ cgroups æ¥åšå®¹å™¨çš„èµ„æºé™åˆ¶(CPUã€å†…å­˜å’Œ IO)



#### Dockerè®¿é—®ç¡¬ä»¶èµ„æº

å®¿ä¸»æœºè¦èƒ½é©±åŠ¨ç¡¬ä»¶ï¼Œå®¹å™¨å…±äº«çš„å®¿ä¸»æœºçš„é©±åŠ¨ã€‚

å¯¹è¾¹ç¼˜è®¾å¤‡è€Œè¨€ï¼Œåœ¨æ”¯æŒå®¹å™¨åŒ–è¿è¡Œçš„æ¡ä»¶ä¸‹ï¼Œéœ€è¦åœ¨å®¹å™¨å†…è·å–å®¿ä¸»æœºçš„ç¡¬ä»¶èµ„æºï¼Œå®Œæˆä¸å®¿ä¸»æœºç¡¬ä»¶èµ„æºçš„äº¤äº’ã€‚é€šå¸¸åœ¨å®¿ä¸»æœºæä¾›é©±åŠ¨çš„æƒ…å†µä¸‹ï¼Œå®¹å™¨å†…éœ€è¦é€šè¿‡SPIã€I2Cã€UARTã€USBç­‰åè®®å®Œæˆæ•°æ®çš„äº¤äº’ã€‚

--device
â€“privileged




## Dockefile

https://blog.51cto.com/14156658/2497164
https://blog.csdn.net/atlansi/article/details/87892016

æ„å»ºDockeré•œåƒ -- DockerFile

DockerFileçš„æŒ‡ä»¤

FROM				  # åŸºç¡€é•œåƒï¼Œä¸€åˆ‡ä»è¿™é‡Œå¼€å§‹æ„å»º
MAINTAINER	  # é•œåƒæ˜¯è°å†™çš„ï¼Œ å§“å+é‚®ç®±
RUN					# é•œåƒæ„å»ºçš„æ—¶å€™éœ€è¦è¿è¡Œçš„å‘½ä»¤
ADD					# æ·»åŠ å†…å®¹ æ·»åŠ åŒç›®å½•
WORKDIR		  # é•œåƒçš„å·¥ä½œç›®å½•
VOLUME			# æŒ‚è½½çš„ç›®å½•
EXPOSE			 # ä¿ç•™ç«¯å£é…ç½®
CMD				   # æŒ‡å®šè¿™ä¸ªå®¹å™¨å¯åŠ¨çš„æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤ï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šç”Ÿæ•ˆï¼Œå¯è¢«æ›¿ä»£ã€‚
ENTRYPOINT	# æŒ‡å®šè¿™ä¸ªå®¹å™¨å¯åŠ¨çš„æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥è¿½åŠ å‘½ä»¤
ONBUILD		   # å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿ DockerFile è¿™ä¸ªæ—¶å€™å°±ä¼šè¿è¡ŒONBUILDçš„æŒ‡ä»¤ï¼Œè§¦å‘æŒ‡ä»¤ã€‚
COPY				#  ç±»ä¼¼ADDï¼Œå°†æˆ‘ä»¬æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­
ENV				   # æ„å»ºçš„æ—¶å€™è®¾ç½®ç¯å¢ƒå˜é‡



## é•œåƒ-UnionFs

[Dockeråˆ†å±‚åŸç†ä¸å†…éƒ¨ç»“æ„](https://blog.csdn.net/runner668/article/details/80955381?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujs&dist_request_id=1332048.22019.16195228904933879&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.baidujs)

é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œä»–åŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚

Dockeré•œåƒåŠ è½½åŸç†
UnionFs ï¼ˆè”åˆæ–‡ä»¶ç³»ç»Ÿ)

UnionFsï¼ˆè”åˆæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼šUnionæ–‡ä»¶ç³»ç»Ÿï¼ˆUnionFsï¼‰æ˜¯ä¸€ç§åˆ†å±‚ã€è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä»–æ”¯æŒå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚çš„å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼ˆ unite several directories into a single virtual filesystem)ã€‚Unionæ–‡ä»¶ç³»ç»Ÿæ˜¯ Dockeré•œåƒçš„åŸºç¡€ã€‚é•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥è¿›è¡Œç»§æ‰¿ï¼ŒåŸºäºåŸºç¡€é•œåƒï¼ˆæ²¡æœ‰çˆ¶é•œåƒï¼‰ï¼Œå¯ä»¥åˆ¶ä½œå„ç§å…·ä½“çš„åº”ç”¨é•œåƒ
ç‰¹æ€§ï¼šä¸€æ¬¡åŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä»å¤–é¢çœ‹èµ·æ¥ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè”åˆåŠ è½½ä¼šæŠŠå„å±‚æ–‡ä»¶ç³»ç»Ÿå åŠ èµ·æ¥ï¼Œè¿™æ ·æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«æ‰€æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•

Dockeré•œåƒåŠ è½½åŸç†

dockerçš„é•œåƒå®é™…ä¸Šç”±ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œè¿™ç§å±‚çº§çš„æ–‡ä»¶ç³»ç»ŸUnionFSã€‚
boots(boot file systemï¼‰ä¸»è¦åŒ…å« bootloaderå’Œ Kernel, bootloaderä¸»è¦æ˜¯å¼•å¯¼åŠ  kernel, Linuxåˆšå¯åŠ¨æ—¶ä¼šåŠ è½½bootfsæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨ Dockeré•œåƒçš„æœ€åº•å±‚æ˜¯ bootfsã€‚è¿™ä¸€å±‚ä¸æˆ‘ä»¬å…¸å‹çš„Linux/Unixç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼ŒåŒ…å«bootåŠ è½½å™¨å’Œå†…æ ¸ã€‚å½“bootåŠ è½½å®Œæˆä¹‹åæ•´ä¸ªå†…æ ¸å°±éƒ½åœ¨å†…å­˜ä¸­äº†ï¼Œæ­¤æ—¶å†…å­˜çš„ä½¿ç”¨æƒå·²ç”± bootfsè½¬äº¤ç»™å†…æ ¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¹Ÿä¼šå¸è½½bootfsã€‚
rootfsï¼ˆroot file system),åœ¨ bootfsä¹‹ä¸Šã€‚åŒ…å«çš„å°±æ˜¯å…¸å‹ Linuxç³»ç»Ÿä¸­çš„/dev,/proc,/bin,/etcç­‰æ ‡å‡†ç›®å½•å’Œæ–‡ä»¶ã€‚ rootfså°±æ˜¯å„ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆï¼Œæ¯”å¦‚ Ubuntu, Centosç­‰ç­‰ã€‚


Dockeré€šè¿‡å­˜å‚¨å¼•æ“ï¼ˆæ–°ç‰ˆæœ¬é‡‡ç”¨å¿«ç…§æœºåˆ¶ï¼‰çš„æ–¹å¼æ¥å®ç°é•œåƒå±‚å †æ ˆï¼Œå¹¶ä¿è¯å¤šé•œåƒå±‚å¯¹å¤–å±•ç¤ºä¸ºç»Ÿä¸€çš„æ–‡ä»¶ç³»ç»Ÿ

Linuxä¸Šå¯ç”¨çš„å­˜å‚¨å¼•æ’ƒæœ‰AUFSã€ Overlay2ã€ Device Mapperã€Btrfsä»¥åŠZFSã€‚é¡¾åæ€ä¹‰ï¼Œæ¯ç§å­˜å‚¨å¼•æ“éƒ½åŸºäº Linuxä¸­å¯¹åº”çš„ä»¶ç³»ç»Ÿæˆ–è€…å—è®¾å¤‡æŠ€æœ¯ï¼Œäº•ä¸”æ¯ç§å­˜å‚¨å¼•æ“éƒ½æœ‰å…¶ç‹¬æœ‰çš„æ€§èƒ½ç‰¹ç‚¹ã€‚

Dockeråœ¨ Windowsä¸Šä»…æ”¯æŒ windowsfilter ä¸€ç§å­˜å‚¨å¼•æ“ï¼Œè¯¥å¼•æ“åŸºäºNTFSæ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šå®ç°äº†åˆ†å±‚å’ŒCoW [1]ã€‚
Docker é•œåƒéƒ½æ˜¯åªè¯»çš„ï¼Œå½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„å¯å†™å±‚åŠ è½½åˆ°é•œåƒçš„é¡¶éƒ¨ï¼
è¿™ä¸€å±‚å°±æ˜¯æˆ‘ä»¬é€šå¸¸è¯´çš„å®¹å™¨å±‚ï¼Œå®¹å™¨ä¹‹ä¸‹çš„éƒ½å«é•œåƒå±‚ï¼